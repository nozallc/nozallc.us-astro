---
import '../styles/global.css';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
import LanguageToggle from '../components/LanguageToggle.astro';

interface Props {
  title: string;
  description: string;
  lang?: string;
  alternateUrl?: string;
}

const { title, description, lang = 'en', alternateUrl } = Astro.props;

// Use production domain for canonical URLs
const productionDomain = 'https://nozallc.us';
const canonicalUrl = `${productionDomain}${Astro.url.pathname}`;
const alternateFullUrl = alternateUrl ? `${productionDomain}${alternateUrl}` : undefined;
---

<!DOCTYPE html>
<html lang={lang === 'es' ? 'es' : 'en'}>
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/NOZA.LOGO.svg" />
		<link rel="apple-touch-icon" href="/NOZA.LOGO.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<meta name="description" content={description} />
		
		<!-- Open Graph Meta Tags -->
		<meta property="og:title" content="NOZA LLC - Digital Marketing & Web Design in Lexington, KY" />
		<meta property="og:description" content="Launch your business into the future with cutting-edge digital marketing, branding, and web design services in Lexington, Kentucky." />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="https://nozallc.us" />
		<meta property="og:image" content="https://nozallc.us/nozallc.svg" />
		<meta property="og:image:alt" content="NOZA LLC - Digital Marketing Agency" />
		
		<!-- Twitter Card Tags -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:title" content="NOZA LLC - Digital Marketing & Web Design" />
		<meta name="twitter:description" content="Digital marketing, branding, websites & business consulting for Lexington KY small businesses." />
		<meta name="twitter:image" content="https://nozallc.us/nozallc.svg" />
		
		<!-- Additional SEO Tags -->
		<meta name="theme-color" content="#0a0e27" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		
		<!-- Canonical URL -->
		<link rel="canonical" href={canonicalUrl} />

		<!-- hreflang tags for language alternates -->
		{lang === 'en' && alternateFullUrl && (
			<>
				<link rel="alternate" hreflang="en" href={canonicalUrl} />
				<link rel="alternate" hreflang="es" href={alternateFullUrl} />
			</>
		)}
		{lang === 'es' && alternateFullUrl && (
			<>
				<link rel="alternate" hreflang="es" href={canonicalUrl} />
				<link rel="alternate" hreflang="en" href={alternateFullUrl} />
			</>
		)}
		
		<!-- DNS Prefetch for CDN -->
		<link rel="dns-prefetch" href="https://cdn.cloudflare.com" />
		
		<!-- Preload critical client JS for faster hydration -->
		<link rel="preload" as="script" href="/_astro/page.B1D-nYk3.js" />
		
		<!-- Schema.org Structured Data -->
		<script type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@type": "LocalBusiness",
			"name": "NOZA LLC",
			"image": "https://nozallc.us/nozallc.svg",
			"description": "Digital marketing, branding, websites & business consulting for Lexington KY small businesses",
			"address": {
				"@type": "PostalAddress",
				"addressLocality": "Lexington",
				"addressRegion": "Kentucky",
				"addressCountry": "US"
			},
			"sameAs": [
				"https://instagram.com/nozallc",
				"https://facebook.com/nozallc",
				"https://linkedin.com/company/nozallc"
			],
			"priceRange": "$$",
			"knowsAbout": ["Digital Marketing", "Web Design", "Branding", "Business Consulting"],
			"areaServed": "Lexington, Kentucky"
		}
		</script>
		
		<!-- Organization Schema -->
		<script type="application/ld+json">
		{
			"@context": "https://schema.org",
			"@type": "Organization",
			"name": "NOZA LLC",
			"url": "https://nozallc.us",
			"logo": "https://nozallc.us/nozallc.svg",
			"contact": {
				"@type": "ContactPoint",
				"telephone": "+1-859-452-8415",
				"contactType": "Business Inquiries"
			}
		}
		</script>
		<!-- Google Analytics 4 (gtag.js) - Production Only -->
		{import.meta.env.PROD && import.meta.env.PUBLIC_GA_MEASUREMENT_ID && (
			<>
				<script async src={`https://www.googletagmanager.com/gtag/js?id=${import.meta.env.PUBLIC_GA_MEASUREMENT_ID}`}></script>
				<script define:vars={{measurementId: import.meta.env.PUBLIC_GA_MEASUREMENT_ID}}>
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());
				// Defer config to after LCP to avoid blocking paint
				if ('requestIdleCallback' in window) {
					requestIdleCallback(() => gtag('config', measurementId));
				} else {
					setTimeout(() => gtag('config', measurementId), 100);
				}
				</script>
			</>
		)}
	</head>
	<body>
		<Nav />
		<slot />
		<Footer lang={lang} />
		<LanguageToggle />
	</body>
</html>
